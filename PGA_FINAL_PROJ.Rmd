---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggplot2)
library(readxl)
library(readxl)
data <- read.csv("PGA_17_22.csv")
newdata <- data[c(1:5,12:14,21,25:27,29,31:37)]
newdata$play_yr <- paste(newdata$player, newdata$season)
```

```{r}
masters <- newdata %>% filter(tournament.name == "Valspar Championship") %>%
  filter(pos == 1)

tidy_tourny <-masters %>%
  pivot_longer(c(15:20), names_to = "Stat_cat", values_to = "response") 

  ggplot(data = tidy_tourny, aes(y = response, x = Stat_cat)) +
  geom_boxplot() +
  #facet_wrap(vars(player))+
  labs(x = "Strokes gained Catagory", y = "Strokes Gained on the Field")

```


```{r}
player_year <- newdata %>% mutate(plyr_yr = as.character(player) + as.character(season))
```

## user selects tournament and sees avg box plot of past winners in each catagpry
```{r}
library(shiny)

ui <- fluidPage(
        fluidRow(
          column(6,
            sidebarLayout(
              sidebarPanel(
                selectizeInput(inputId ="Tournychoice",
                               label = "Choose a Tournament",
                               choices = levels(
                                  factor(newdata$tournament.name)),
                               selected = ("Valspar Championship"))),
                  mainPanel(plotOutput(outputId = "majorplot"))))),
        fluidRow(
          column(8,
            plotOutput(outputId = "minorplot"))
  
)
)


server <- function(input, output, session) {
  
  df_update <- reactive({
    
    df_stat <- newdata %>% filter(tournament.name == input$Tournychoice) 
    
    df_win <- df_stat %>% filter(pos == 1)%>%
      pivot_longer(c(15:20), 
                   names_to = "Stat_cat", values_to = "response") %>%
      mutate(play_yr = fct_reorder(play_yr, desc(strokes))) 

  })
  
  
  output$majorplot <- renderPlot({
    
    ggplot(data = df_update(), aes(x = Stat_cat, y = response)) +
      geom_boxplot() +
      labs(x = "Strokes gained Catagory", 
           y = "Strokes Gained on the Field")
  })
  
  output$minorplot <- renderPlot({
    
    ggplot(data = df_update(), aes(x = play_yr, y = strokes))+
      geom_point() + 
      geom_segment( aes(x= play_yr, xend= play_yr, y=0, yend=strokes))+
      coord_flip()+
      geom_text(aes(label = strokes), vjust = 1.5, colour = "black")+
      ylim(0,288)
    
    
  })
  
  
}

shinyApp(ui, server)

```




```{r}
masters <- masters %>% mutate(player = fct_reorder(player, desc(strokes)))

ggplot(data = masters, aes(x = player, y = strokes))+
  geom_point() + 
  geom_segment( aes(x= player, xend= player, y=0, yend=strokes))+
  coord_flip()+
  geom_text(aes(label = strokes), vjust = 1.5, colour = "black")+
  ylim(0,288)

```

## graph of last 6 winners score 


```{r}
library(tidyverse)
library(viridis)
library(patchwork)
library(hrbrthemes)
library(fmsb)
library(colormap)

data_compare <- newdata[c(9,15:20)]
data_compare <- data_compare %>% filter(player == "Jon Rahm" | player == "Jordan Spieth")

JJ <- data_compare %>% group_by(player) %>%
  summarise(avg_putt = sum(sg_putt))



colors_border=c( rgb(0.2,0.5,0.5,0.9), rgb(0.8,0.2,0.5,0.9)  )
colors_in=c( rgb(0.2,0.5,0.5,0.4), rgb(0.8,0.2,0.5,0.4)  )

# Custom the radarChart !
radarchart( data_compare, axistype=1, 

  #custom polygon
  pcol=colors_border , pfcol=colors_in , plwd=4, plty=1 , 

  #custom the grid
  cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=1.1,

  #custom labels
  vlcex=0.8 
  )

# Legend
legend(x=0.85, y=1, legend = c("Golfer1", "Golfer2"), bty = "n", pch=20 , col=colors_border , text.col = "black", cex=0.9, pt.cex=1.6)
```
due to missing data ?

```{r}
library(hrbrthemes)
library(GGally)
library(viridis)

# Data set is provided by R natively
iris_data<- iris

Valspar <- newdata %>% filter(tournament.name == "Valspar Championship")

#%>%group_by(player)%>% mutate(haswon = if_else(min(pos) == 1,
                          #true = "yes",
                          #false = "no"))
  





# Plot
ggparcoord(data2,
    columns = 15:20, groupColumn = 9, order = "anyClass",
    showPoints = TRUE, 
    title = "Parallel Coordinate Plot for Past Winners",
    alphaLines = 0.3
    ) + 
  scale_color_viridis(discrete=TRUE) +
  theme_ipsum()+
  theme(
    plot.title = element_text(size=10)
  )


```

REPREX
```{r}
library(tidyverse)
test_df2 <- tibble(player = c("Caleb", "Caleb", "Caleb","Jeff","Bob"),
                   standings = c(1, 10, 7, 5, 1))
test_df2 

test_df2 %>% group_by(player) %>%
  mutate(haswon = if_else(min(standings) == 1,
                          true = "yes",
                          false = "no"))



test_want <-tibble(player = c("Caleb", "Caleb", "Caleb","Jeff","Bob"),
                   standings = c(1, 10, 7, 5, 1),
                   haswon = c("yes","yes","yes","no","yes"))
test_want
```

