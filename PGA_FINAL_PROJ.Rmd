---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggplot2)
library(readxl)
library(readxl)
data <- read.csv("PGA_17_22.csv")
newdata <- data[c(1:5,12:14,21,25:27,29,31:37)]
```

```{r}
masters <- newdata %>% filter(tournament.name == "Valspar Championship") %>%
  filter(pos == 1)

tidy_tourny <-masters %>%
  pivot_longer(c(15:20), names_to = "Stat_cat", values_to = "response") 

  ggplot(data = tidy_tourny, aes(y = response, x = Stat_cat)) +
  geom_boxplot() +
  #facet_wrap(vars(player))+
  labs(x = "Strokes gained Catagory", y = "Strokes Gained on the Field")

```

## user selects tournament and sees avg box plot of past winners in each catagpry

```{r}
masters <- masters %>% mutate(player = fct_reorder(player, desc(strokes)))
ggplot(data = masters, aes(x = player, y = strokes))+
  geom_point() + 
  geom_segment( aes(x= player, xend= player, y=0, yend=strokes))+
  coord_flip()+
  geom_text(aes(label = strokes), vjust = 1.5, colour = "black")+
  ylim(0,288)

```

## graph of last 6 winners score 


```{r}
library(tidyverse)
library(viridis)
library(patchwork)
library(hrbrthemes)
library(fmsb)
library(colormap)

data_compare <- newdata[c(9,15:20)]
data_compare <- data_compare %>% filter(player == "Jon Rahm" | player == "Jordan Spieth")

JJ <- data_compare %>% group_by(player) %>%
  summarise(avg_putt = sum(sg_putt))



colors_border=c( rgb(0.2,0.5,0.5,0.9), rgb(0.8,0.2,0.5,0.9)  )
colors_in=c( rgb(0.2,0.5,0.5,0.4), rgb(0.8,0.2,0.5,0.4)  )

# Custom the radarChart !
radarchart( data_compare, axistype=1, 

  #custom polygon
  pcol=colors_border , pfcol=colors_in , plwd=4, plty=1 , 

  #custom the grid
  cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=1.1,

  #custom labels
  vlcex=0.8 
  )

# Legend
legend(x=0.85, y=1, legend = c("Golfer1", "Golfer2"), bty = "n", pch=20 , col=colors_border , text.col = "black", cex=0.9, pt.cex=1.6)
```

